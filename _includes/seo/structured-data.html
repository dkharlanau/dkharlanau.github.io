{% assign resume = site.data.resume %}
{% assign canonical_url = page.url | absolute_url %}
{% assign site_home = '/' | absolute_url %}
{% assign author_id = 'https://dkharlanau.github.io/#dkharlanau' %}
{% assign og_image = page.og_image | default: '/assets/og/default.png' | absolute_url %}
{% assign page_description = page.description | default: page.summary | default: page.excerpt | default: site.description | strip_html | normalize_whitespace %}
{% assign datasets = site.data.datasets | default: empty %}
{% assign primary_dataset = datasets | first %}
{% assign catalog_id = 'https://dkharlanau.github.io/ai/catalog.json#catalog' %}
{% assign catalog_url = 'https://dkharlanau.github.io/ai/catalog.json' %}

{% if primary_dataset %}
<script type="application/ld+json">
{{ primary_dataset | jsonify }}
</script>
{% endif %}

{% if datasets and datasets.size > 0 %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "DataCatalog",
  "@id": "{{ catalog_id }}",
  "name": "DKharlanau Professional Data Catalog",
  "url": "{{ catalog_url }}",
  "creator": {
    "@type": "Person",
    "@id": "{{ author_id }}",
    "name": "Dzmitryi Kharlanau",
    "url": "{{ site_home }}"
  },
  "dataset": {{ datasets | jsonify }}
}
</script>
{% endif %}

{% if page.collection == 'notes' %}
{% assign article_published = page.date | default: page.published | default: site.time %}
{% assign article_modified = page.last_modified_at | default: page.updated %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ page.title | strip_html | normalize_whitespace | replace: '\"', '\\\"' }}",
  "description": "{{ page_description | truncate: 160 | replace: '\"', '\\\"' }}",
  "author": {
    "@id": "{{ author_id }}"
  },
  "datePublished": "{{ article_published | date_to_xmlschema }}",
  {% if article_modified %}"dateModified": "{{ article_modified | date_to_xmlschema }}",{% endif %}
  "image": "{{ og_image }}",
  "mainEntityOfPage": "{{ canonical_url }}",
  "url": "{{ canonical_url }}"
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {"@type": "ListItem","position": 1,"name": "Home","item": "{{ site_home }}"},
    {"@type": "ListItem","position": 2,"name": "Notes","item": "{{ '/notes/' | absolute_url }}"},
    {"@type": "ListItem","position": 3,"name": "{{ page.title | strip_html | normalize_whitespace | replace: '\"', '\\\"' }}","item": "{{ canonical_url }}"}
  ]
}
</script>
{% elsif page.layout == 'blog' or page.collection == 'blog' %}
{% assign article_published = page.date | default: page.published | default: site.time %}
{% assign article_modified = page.last_modified_at | default: page.updated %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ page.title | strip_html | normalize_whitespace | replace: '\"', '\\\"' }}",
  "description": "{{ page_description | truncate: 160 | replace: '\"', '\\\"' }}",
  "author": {
    "@id": "{{ author_id }}"
  },
  "datePublished": "{{ article_published | date_to_xmlschema }}",
  {% if article_modified %}"dateModified": "{{ article_modified | date_to_xmlschema }}",{% endif %}
  "image": "{{ og_image }}",
  {% if page.tags %}"keywords": [{% for tag in page.tags %}"{{ tag | replace: '\"', '\\\"' }}"{% unless forloop.last %},{% endunless %}{% endfor %}],{% endif %}
  "mainEntityOfPage": "{{ canonical_url }}",
  "url": "{{ canonical_url }}"
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {"@type": "ListItem","position": 1,"name": "Home","item": "{{ site_home }}"},
    {"@type": "ListItem","position": 2,"name": "Blog","item": "{{ '/blog/' | absolute_url }}"},
    {"@type": "ListItem","position": 3,"name": "{{ page.title | strip_html | normalize_whitespace | replace: '\"', '\\\"' }}","item": "{{ canonical_url }}"}
  ]
}
</script>
{% elsif page.url == '/notes/' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {"@type": "ListItem","position": 1,"name": "Home","item": "{{ site_home }}"},
    {"@type": "ListItem","position": 2,"name": "Notes","item": "{{ canonical_url }}"}
  ]
}
</script>
{% endif %}
