<html>
<head>
  <title>How to add customer-specific fields to BP in SAP S4 on premise</title>
  <style>
    body {
      margin: 0 auto;
      width: 744px;
      font-family: Source Serif Pro, serif;
      line-height: 32px;
      font-weight: 400;
      color: rgba(0, 0, 0, 0.7);
      font-size: 21px;
    }
    h1, h2, h3 {
      font-family: Source Sans Pro, Helvetica, Arial, sans-serif;
    }
    h1 a, h1 a:visited {
      color: inherit;
      text-decoration: none;
    }
    h1 {
      line-height: 48px;
      font-weight: 600;
      color: rgba(0, 0, 0, 0.85);
      font-size: 42px;
      margin: 32px 0 20px;
    }
    h2 {
      line-height: 32px;
      font-weight: 600;
      color: rgba(0, 0, 0, 0.85);
      font-size: 26px;
      margin: 28px 0;
    }
    h3 {
      line-height: 28px;
      font-weight: 600;
      color: rgba(0, 0, 0, 0.85);
      font-size: 21px;
      margin: 24px 0;
    }
    p {
      margin: 32px 0;
    }
    .created, .published {
      color: rgba(0, 0, 0, 0.55);
      font-size: 15px;
      line-height: 15px;
      margin: 20px 0;
    }
    .created + .published {
      margin-top: -12px;
    }
    blockquote {
      font-family: Georgia, Source Serif Pro, serif;
      font-style: italic;
      font-size: 24px;
      line-height: 36px;
      margin: 48px 120px;
      text-align: center;
    }
    a {
      word-wrap: break-word;
      outline: none;
      text-decoration: none;
      background-color: transparent;
      border: 0;
      color: #008CC9;
    }
    a:hover {
      text-decoration: underline;
    }
    a:visited {
      color: #8C68CB;
    }
    .center {
      text-align: center;
    }
    iframe {
      display: block;
      margin: 44px auto;
    }
    *:not(pre) + pre, pre:first-of-type {
      margin-top: 32px;
      padding-top: 32px;
    }
    pre:only-of-type {
      margin: 32px 0;
      padding: 32px;
    }
    pre {
      background: #F3F6F8;
      overflow-x: auto;
      display: block;
      font-size: 13px;
      font-family: monospace;
      line-height: 13px;
      padding: 0 32px 32px;
      white-space: pre;
    }
    a.embedded {
      background: #F3F6F8;
      display: block;
      padding: 32px;
      margin: 32px 0;
    }
    img {
      height: auto;
      max-width: 100%;
    }
    .slate-image-embed__resize-full-width img {
      width: 100%;
    }
    .series-logo {
      width: 48px;
      height: 48px;
      box-sizing: border-box;
      background-clip: content-box;
      border: 4px solid transparent;
      border-radius: 6px;
      object-fit: scale-down;
      float: left;
    }
    .series-title {
      font-size: 16px;
      font-weight: 600;
      vertical-align: top;
    }
    .series-description {
      color: rgba(0,0,0,.6);
      font-weight: 400;
      font-size: 14px;
      line-height: 20px;
    }
    div {
      margin: 32px 0;
    }
  </style>
</head>
<body>
      <h1><a href="https://www.linkedin.com/pulse/how-add-customer-specific-fields-bp-sap-s4-premise-%D0%B4%D0%BC%D0%B8%D1%82%D1%80%D0%B8%D0%B9-%D1%85%D0%B0%D1%80%D0%BB%D0%B0%D0%BD%D0%BE%D0%B2">How to add customer-specific fields to BP in SAP S4 on premise</a></h1>
    <p class="created">Created on 2022-04-08 08:20</p>
  <p class="published">Published on 2022-04-08 09:37</p>
  <div><p><strong><em>How to make customer enhancements to the customer/vendor integration in order to integrate additional customer/vendor fields in the business partner and to use CVI synchronization to update?</em></strong></p><ul><li><p>Context: SAP S4/HANA on premise, 105</p></li><li><p>Need: Include customer-specific customer/vendor fields in transaction <em>BP - Maintain Business Partner</em>&nbsp;. </p></li><li><p>Guide: 2309153 - BP_CVI: Guideline Version 1.14 for customer enhancements in CVI (customer/vendor integration) in SAP S/4HANA releases</p></li></ul><p>Migrating to SAP S/4 HANA, traditional customer/vendor master transactions became obsolete and have been replaced by the data model of the business partner. Therefore, all extension-specific fields have to be integrated into the new business partner entity.</p><p>Enhancements to the SAP Business Partner are supported by using these tools: </p><ol><li><p><strong>BDT (Business Data Tool Set)</strong> is to enhance the existing screens in transaction with the additional fields, tables or checkboxes</p></li><li><p><strong>XO Framework (Extensible Objects)</strong> is to validate and to store the data in the memory. See SAP note 1623809.</p></li><li><p><strong>CVI Synchronization</strong> is to collect the data from XO memory and save it to the database.</p></li></ol><p>Extending BP one of the option should be considered, dependent on the option, the way to extend and integrate customer-specific fields/sources is different: </p><ol><li><p><strong>Scenario A: Integration of complete tables in customer namespace that refer to customer / vendor master</strong></p></li><li><p><strong>Scenario B: Integration of own appends of customer/vendor master core tables </strong></p></li></ol><p>The method for Scenario B is explained using a test example with a requirement to add a new customer-specific field ( <em>relevancy indicator for external transportation management</em> ) at purchasing data for the supplier.</p><p></p><h2>1) Analyze and adopt data model</h2><h3>Scenario A: Extend data model with new fields via append</h3><p>Extend the table <em>LFM1 Vendor master record purchasing organization data</em> with new customer-specific fields with the append structure as this level fits to the requirement. A purhcase order or stock transfer order can be relevant for distributing to external TM.</p><p></p><h2>2) Use Business Data Tool Set for UI changes</h2><h3>Find a place to include new fields at screens</h3><p>Using the function code <strong>BDT_ANALYZER</strong> in the command line within a BDT application, it shows a details regarding screen/section/view/field data. </p><p>With the test example, we will add a new view with a new field under the standard field <em>Mode of Transport</em></p><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQH2BmsjjF48OA" src="https://media.licdn.com/dms/image/v2/C5612AQH2BmsjjF48OA/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1649406788107?e=1761782400&amp;v=beta&amp;t=Y8XxRvzcAkUMySFb-9JFu52JX56fAq824d0G3f5ZmcM"><figcaption></figcaption></figure><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQETNjaYbtPQUA" src="https://media.licdn.com/dms/image/v2/C5612AQETNjaYbtPQUA/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1649406854354?e=1761782400&amp;v=beta&amp;t=3pB2YW-TskhM80IpPT60AFITivgQsLUbWXWHmivGfuA"><figcaption></figcaption></figure><p>Using the data ( application, data set, view ) we can identify and orient in the structure to place a new view.</p><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQHgdZ5JciRlEQ" src="https://media.licdn.com/dms/image/v2/C5612AQHgdZ5JciRlEQ/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1649406885431?e=1761782400&amp;v=beta&amp;t=s1ZclJO8XN3Zvhf-G50yX6-U-Drjt1HfTfQwNBlFNhc"><figcaption></figcaption></figure><h3>BTD field group</h3><p>On field group level the fields from the dynpro are assigned using transaction code: BUS2 - Field Groups. <strong>Important: only one field per field group!</strong></p><p>In addition, we can add a function module for FMOD2 event in the field group. If we do not have any specific field modification logic for our field groups we can add the standard FMOD-function modules.  </p><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQHZEdFVnxkf0A" src="https://media.licdn.com/dms/image/v2/C5612AQHZEdFVnxkf0A/article-inline_image-shrink_1500_2232/article-inline_image-shrink_1500_2232/0/1649406926116?e=1761782400&amp;v=beta&amp;t=qlLq09kE9AyOJUB9uxxeI7TcEQ8nN1vCdVNKuQQt0QI"><figcaption></figcaption></figure><p>Include two records for data and screen fields:</p><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQH3OrTlnkdjAA" src="https://media.licdn.com/dms/image/v2/C5612AQH3OrTlnkdjAA/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1649406957813?e=1761782400&amp;v=beta&amp;t=zg5QDpuh1MxlpINQA1CfOtwEbQfIBx_P3VEosdtJndw"><figcaption></figcaption></figure><p>Use the namespace for the field group: 06*, 070*-074*</p><h3>BTD view</h3><p>The view is the central object in BDT as it contains the connection to a function group where the input fields are defined.</p><p>Transaction BUS3 - Views: create a new view for the customer specific fields.</p><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQGHIDAiww4H6g" src="https://media.licdn.com/dms/image/v2/C5612AQGHIDAiww4H6g/article-inline_image-shrink_1500_2232/article-inline_image-shrink_1500_2232/0/1649407003954?e=1761782400&amp;v=beta&amp;t=hnaFVBzvuLaQUjvZVveAx2NJY6OC2g_cykzK9ouxbcs"><figcaption></figcaption></figure><p>Creating a new function group to store a screen and PAI + PBO functions.</p><p>Please, note that we use <strong>cvi_bdt_adapter</strong> to get and update runtime data of BP for the appropriate level of the Business partner.</p><p><strong>Process before output</strong></p><pre></pre><p><strong>Process after input </strong></p><pre></pre><p>Assign field groups to the view: </p><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQGJ--Df5YQUwg" src="https://media.licdn.com/dms/image/v2/C5612AQGJ--Df5YQUwg/article-inline_image-shrink_1500_2232/article-inline_image-shrink_1500_2232/0/1649407026645?e=1761782400&amp;v=beta&amp;t=84hs33lhfj_rKOb_1dJeyuGDv6jja9Q7aE5ve-spKNQ"><figcaption></figcaption></figure><h3>BDT section</h3><p>For any new field or set of fields, we need to create a section. Assign only those views to a section that fit together. A new view is set under the View CVIV50 where the field <em>Mode of transport</em> is located. </p><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQGP6buv8touEg" src="https://media.licdn.com/dms/image/v2/C5612AQGP6buv8touEg/article-inline_image-shrink_1500_2232/article-inline_image-shrink_1500_2232/0/1649407178175?e=1761782400&amp;v=beta&amp;t=IHNIHZp8rVcvg_rSDamWlg0ilgbp9WWvyMrOScT5Le8"><figcaption></figcaption></figure><p>Create a subscreen for a function group</p><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQFHg_3nDdWLKw" src="https://media.licdn.com/dms/image/v2/C5612AQFHg_3nDdWLKw/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1649407235304?e=1761782400&amp;v=beta&amp;t=VInEh8jnI4NEKocSCktz34ZPItn8mVMbU7hM-9ln_qQ"><figcaption></figcaption></figure><p>In PAI of the screen</p><pre></pre><p>In PBO of the screen</p><pre></pre><h3>BDT events ( not mandatory for test example )</h3><p>Сare about BDT events in case we do anything special like for example adding some buttons for navigating to a popup.</p><p></p><h2>3) Use XO Framework – Extensible Objects to link UI field to the interface of BP</h2><h3>Scenario A: Integration of own tables  </h3><p>For each database table is to be integrated into transaction BP a memory object class is needed. The class has to inherit from class CVI_MO_CUSTOMER for customer data or from class CVI_MO_VENDOR for vendor data.</p><h3>Scenario B: Integration of core table appends</h3><p>All appends of customer/vendor core tables like KNA1, KNB1, LFA1 or LFB1 are already available in the corresponding XO memory object. There is no need to create any new memory object or any new class. </p><p>The only thing to do here is to implement the validation logic for your appended fields. Needed validations will be handled in a validation class, which is registered in XO customizing as a so-called Validation Object .</p><p></p><h2>4) CVI – Saving data to database</h2><p>While maintaining business partner data in transaction BP the data are only retrieved and transferred back to the XO memory and validations are executed. Saving of changed customer/vendor data to database is collectively triggered on commit after the button “Save” has been pressed. </p><p>The CVI offers two enhancement spots for saving data: CUSTOMER_EXTENSION and VENDOR_EXTENSION.</p><h3>Scenario A: Saving data in own tables </h3><p>For saving data stored in own tables, the CVI synchronization provides several BAdIs, which have to be implemented in this scenario.</p><h3>Scenario B: Saving data in core table appends</h3><p>Extend the complex structure <strong>CVIS_EI_EXTERN</strong> with the appended fields in the structures DATA and DATAX in the corresponding core table section.</p><p>Example with extending the Supplier purchasing data, SE11: </p><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQEyOU8OmV7DYw" src="https://media.licdn.com/dms/image/v2/C5612AQEyOU8OmV7DYw/article-inline_image-shrink_1000_1488/article-inline_image-shrink_1000_1488/0/1649406535498?e=1761782400&amp;v=beta&amp;t=fI1jLpsDW1GcAtiQg5bDQF2tY_g8mm0Me1enRZtoaSs"><figcaption></figcaption></figure><pre></pre><h2>Result</h2><p>After all these actions the field is integrated: ( available for the edit, not editable in the display mode, with the change the value is transferred to DB ) </p><figure><img data-media-urn="urn:li:digitalmediaAsset:C5612AQF_G58U9RHG6A" src="https://media.licdn.com/dms/image/v2/C5612AQF_G58U9RHG6A/article-inline_image-shrink_1500_2232/article-inline_image-shrink_1500_2232/0/1649410047931?e=1761782400&amp;v=beta&amp;t=7GGhnVfF5VqZZh_SfV4hhdvl00ICO1vW4hDYFvQGYf8"><figcaption></figcaption></figure><p>The available tools allow easily to integrate customer-specific fields into the new Business partner data model and adjust the transactions available for maintenance of this business object. It simplifies development and reduces the costs in mid-term period ( as to get acknowledged with these tools also requires some expertise of these frameworks ).</p><p></p><p></p></div>
</body>
</html>